<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½‘ç»œè¿æ¥è¯Šæ–­å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #4a5568;
            text-align: center;
            margin-bottom: 30px;
        }
        .diagnostic-item {
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e2e8f0;
        }
        .diagnostic-item.testing {
            border-left-color: #3182ce;
            background: #ebf8ff;
        }
        .diagnostic-item.success {
            border-left-color: #38a169;
            background: #f0fff4;
        }
        .diagnostic-item.error {
            border-left-color: #e53e3e;
            background: #fed7d7;
        }
        .btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .btn:hover {
            background: #3182ce;
        }
        .log {
            background: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.success { background: #38a169; color: white; }
        .status.error { background: #e53e3e; color: white; }
        .status.testing { background: #3182ce; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ç½‘ç»œè¿æ¥è¯Šæ–­å·¥å…·</h1>
        
        <div class="diagnostic-item">
            <h3>ğŸŒ åŸºç¡€ç½‘ç»œè¿æ¥æµ‹è¯•</h3>
            <div id="basic-network">
                <span class="status testing">ç­‰å¾…æµ‹è¯•</span>
                <span>æ£€æŸ¥åŸºç¡€ç½‘ç»œè¿æ¥...</span>
            </div>
        </div>

        <div class="diagnostic-item">
            <h3>ğŸ”¥ ç«å±±å¼•æ“APIè¿æ¥æµ‹è¯•</h3>
            <div id="volcengine-api">
                <span class="status testing">ç­‰å¾…æµ‹è¯•</span>
                <span>æ£€æŸ¥ç«å±±å¼•æ“APIå¯è¾¾æ€§...</span>
            </div>
        </div>

        <div class="diagnostic-item">
            <h3>ğŸŒ å›½é™…ç½‘ç»œè¿æ¥æµ‹è¯•</h3>
            <div id="international-network">
                <span class="status testing">ç­‰å¾…æµ‹è¯•</span>
                <span>æ£€æŸ¥å›½é™…ç½‘ç»œè¿æ¥ï¼ˆVPNæ£€æµ‹ï¼‰...</span>
            </div>
        </div>

        <div class="diagnostic-item">
            <h3>ğŸ”§ æµè§ˆå™¨ç¯å¢ƒæ£€æµ‹</h3>
            <div id="browser-env">
                <span class="status testing">ç­‰å¾…æµ‹è¯•</span>
                <span>æ£€æŸ¥æµè§ˆå™¨ç¯å¢ƒå’ŒåŠŸèƒ½æ”¯æŒ...</span>
            </div>
        </div>

        <div style="text-align: center; margin: 30px 0;">
            <button class="btn" onclick="runDiagnostics()">ğŸš€ å¼€å§‹è¯Šæ–­</button>
            <button class="btn" onclick="clearLog()">ğŸ—‘ï¸ æ¸…é™¤æ—¥å¿—</button>
        </div>

        <div class="log" id="diagnostic-log">
            <div>ğŸ“‹ è¯Šæ–­æ—¥å¿—å°†åœ¨è¿™é‡Œæ˜¾ç¤º...</div>
        </div>
    </div>

    <script>
        let logElement = document.getElementById('diagnostic-log');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : 'â„¹ï¸';
            logElement.innerHTML += `<div>[${timestamp}] ${prefix} ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function updateStatus(elementId, status, message) {
            const element = document.getElementById(elementId);
            const statusSpan = element.querySelector('.status');
            const textSpan = element.querySelector('span:last-child');
            
            statusSpan.className = `status ${status}`;
            statusSpan.textContent = status === 'success' ? 'âœ… æˆåŠŸ' : 
                                   status === 'error' ? 'âŒ å¤±è´¥' : 'ğŸ”„ æµ‹è¯•ä¸­';
            textSpan.textContent = message;
        }

        function clearLog() {
            logElement.innerHTML = '<div>ğŸ“‹ è¯Šæ–­æ—¥å¿—å·²æ¸…é™¤...</div>';
        }

        async function testBasicNetwork() {
            log('å¼€å§‹åŸºç¡€ç½‘ç»œè¿æ¥æµ‹è¯•...');
            updateStatus('basic-network', 'testing', 'æ­£åœ¨æµ‹è¯•åŸºç¡€ç½‘ç»œè¿æ¥...');
            
            try {
                const response = await fetch('https://www.baidu.com', {
                    method: 'HEAD',
                    mode: 'no-cors',
                    cache: 'no-cache'
                });
                
                updateStatus('basic-network', 'success', 'åŸºç¡€ç½‘ç»œè¿æ¥æ­£å¸¸');
                log('åŸºç¡€ç½‘ç»œè¿æ¥æµ‹è¯•é€šè¿‡', 'success');
                return true;
            } catch (error) {
                updateStatus('basic-network', 'error', 'åŸºç¡€ç½‘ç»œè¿æ¥å¤±è´¥');
                log(`åŸºç¡€ç½‘ç»œè¿æ¥å¤±è´¥: ${error.message}`, 'error');
                return false;
            }
        }

        async function testVolcengineAPI() {
            log('å¼€å§‹ç«å±±å¼•æ“APIè¿æ¥æµ‹è¯•...');
            updateStatus('volcengine-api', 'testing', 'æ­£åœ¨æµ‹è¯•ç«å±±å¼•æ“APIè¿æ¥...');
            
            try {
                const response = await fetch('https://visual.volcengineapi.com', {
                    method: 'HEAD',
                    mode: 'no-cors',
                    cache: 'no-cache'
                });
                
                updateStatus('volcengine-api', 'success', 'ç«å±±å¼•æ“APIè¿æ¥æ­£å¸¸');
                log('ç«å±±å¼•æ“APIè¿æ¥æµ‹è¯•é€šè¿‡', 'success');
                return true;
            } catch (error) {
                updateStatus('volcengine-api', 'error', 'ç«å±±å¼•æ“APIè¿æ¥å¤±è´¥');
                log(`ç«å±±å¼•æ“APIè¿æ¥å¤±è´¥: ${error.message}`, 'error');
                return false;
            }
        }

        async function testInternationalNetwork() {
            log('å¼€å§‹å›½é™…ç½‘ç»œè¿æ¥æµ‹è¯•...');
            updateStatus('international-network', 'testing', 'æ­£åœ¨æµ‹è¯•å›½é™…ç½‘ç»œè¿æ¥...');
            
            try {
                const response = await fetch('https://www.google.com', {
                    method: 'HEAD',
                    mode: 'no-cors',
                    cache: 'no-cache'
                });
                
                updateStatus('international-network', 'success', 'å›½é™…ç½‘ç»œè¿æ¥æ­£å¸¸ï¼ˆå¯èƒ½ä½¿ç”¨VPNï¼‰');
                log('å›½é™…ç½‘ç»œè¿æ¥æµ‹è¯•é€šè¿‡ï¼Œæ£€æµ‹åˆ°å¯èƒ½çš„VPNè¿æ¥', 'success');
                return true;
            } catch (error) {
                updateStatus('international-network', 'error', 'å›½é™…ç½‘ç»œè¿æ¥å¤±è´¥ï¼ˆæ— VPNæˆ–VPNå¼‚å¸¸ï¼‰');
                log(`å›½é™…ç½‘ç»œè¿æ¥å¤±è´¥: ${error.message}`, 'error');
                return false;
            }
        }

        function testBrowserEnvironment() {
            log('å¼€å§‹æµè§ˆå™¨ç¯å¢ƒæ£€æµ‹...');
            updateStatus('browser-env', 'testing', 'æ­£åœ¨æ£€æµ‹æµè§ˆå™¨ç¯å¢ƒ...');
            
            const checks = {
                'Fetch API': typeof fetch !== 'undefined',
                'Web Crypto API': typeof crypto !== 'undefined' && typeof crypto.subtle !== 'undefined',
                'Local Storage': typeof localStorage !== 'undefined',
                'Console API': typeof console !== 'undefined'
            };

            let allPassed = true;
            for (const [feature, supported] of Object.entries(checks)) {
                if (supported) {
                    log(`${feature}: æ”¯æŒ`, 'success');
                } else {
                    log(`${feature}: ä¸æ”¯æŒ`, 'error');
                    allPassed = false;
                }
            }

            if (allPassed) {
                updateStatus('browser-env', 'success', 'æµè§ˆå™¨ç¯å¢ƒå®Œå…¨å…¼å®¹');
                log('æµè§ˆå™¨ç¯å¢ƒæ£€æµ‹é€šè¿‡', 'success');
            } else {
                updateStatus('browser-env', 'error', 'æµè§ˆå™¨ç¯å¢ƒå­˜åœ¨å…¼å®¹æ€§é—®é¢˜');
                log('æµè§ˆå™¨ç¯å¢ƒæ£€æµ‹å‘ç°é—®é¢˜', 'error');
            }

            // é¢å¤–ä¿¡æ¯
            log(`æµè§ˆå™¨: ${navigator.userAgent}`);
            log(`å½“å‰URL: ${window.location.href}`);
            
            return allPassed;
        }

        async function runDiagnostics() {
            log('ğŸš€ å¼€å§‹å®Œæ•´ç½‘ç»œè¯Šæ–­...');
            
            // æ¸…é™¤ä¹‹å‰çš„çŠ¶æ€
            ['basic-network', 'volcengine-api', 'international-network', 'browser-env'].forEach(id => {
                updateStatus(id, 'testing', 'ç­‰å¾…æµ‹è¯•...');
            });

            // ä¾æ¬¡æ‰§è¡Œæµ‹è¯•
            const basicResult = await testBasicNetwork();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            const volcengineResult = await testVolcengineAPI();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            const internationalResult = await testInternationalNetwork();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            const browserResult = testBrowserEnvironment();

            // ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š
            log('ğŸ“Š è¯Šæ–­æŠ¥å‘Šç”Ÿæˆä¸­...');
            
            if (!basicResult) {
                log('ğŸ”´ ä¸¥é‡é—®é¢˜ï¼šåŸºç¡€ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®', 'error');
            } else if (!volcengineResult && internationalResult) {
                log('ğŸŸ¡ VPNé—®é¢˜ï¼šVPNå¯èƒ½é˜»æ­¢äº†ç«å±±å¼•æ“APIè®¿é—®ï¼Œå»ºè®®æš‚æ—¶å…³é—­VPN', 'error');
            } else if (!volcengineResult && !internationalResult) {
                log('ğŸŸ¡ ç½‘ç»œé™åˆ¶ï¼šå¯èƒ½å­˜åœ¨é˜²ç«å¢™æˆ–ç½‘ç»œé™åˆ¶', 'error');
            } else if (volcengineResult && basicResult) {
                log('ğŸŸ¢ ç½‘ç»œçŠ¶æ€è‰¯å¥½ï¼šæ‰€æœ‰è¿æ¥æµ‹è¯•é€šè¿‡', 'success');
            }

            if (!browserResult) {
                log('ğŸ”´ æµè§ˆå™¨é—®é¢˜ï¼šæµè§ˆå™¨ç¯å¢ƒä¸å…¼å®¹ï¼Œå»ºè®®æ›´æ–°æµè§ˆå™¨', 'error');
            }

            log('âœ… è¯Šæ–­å®Œæˆï¼è¯·æ ¹æ®ä¸Šè¿°ç»“æœè¿›è¡Œç›¸åº”çš„ç½‘ç»œè°ƒæ•´ã€‚');
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯
        window.onload = function() {
            log('ğŸ” ç½‘ç»œè¯Šæ–­å·¥å…·å·²åŠ è½½');
            log('ç‚¹å‡»"å¼€å§‹è¯Šæ–­"æŒ‰é’®å¼€å§‹æ£€æµ‹ç½‘ç»œçŠ¶å†µ');
        };
    </script>
</body>
</html> 